# Разработка интеллектуальной системы для решения кейса "Предсказание социально-демографических характеристик пользователя".

## Описание проблемы

Пользователи RUTUBE не всегда указывают свои данные, такие как возраст и пол, что затрудняет формирование портрета пользователя и создание персонализированных рекомендаций. Это ограничивает возможности платформы в предоставлении контента, который наиболее подходит интересам и потребностям пользователей, тем самым ухудшая пользовательский опыт.

Необходимо разработать модель, которая на основе истории просмотров сможет предсказывать пол и возраст пользователя. Подобные данные смогут служить сильными признаками в моделях рекомендательной системы, поиска и модерации контента платформы.

## :hammer: Описание стека использованных технологий

Для анализа набора данных (далее - датасета), визуализации и выявления паттернов, а также для создания модели предсказания социально-демографических признаков пользователя был использован следующий стек технологий:

 <img src="https://raw.githubusercontent.com/devicons/devicon/1119b9f84c0290e0f0b38982099a2bd027a48bf1/icons/python/python-original.svg" height="75" width="75">
Python - это высокоуровневый язык программирования общего назначения с динамической строгой типизацией и автоматическим управлением памятью, ориентированный на повышение производительности разработчика, читаемости кода и его качества, а также на обеспечение переносимости написанных на нём программ.

---
<img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/pandas/pandas-original.svg" height="75" width="75">
Pandas - это быстрый, мощный, гибкий и простой в использовании инструмент анализа данных с открытым исходным кодом и манипулирования ими, построенный на основе языка программирования Python.

---

<img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/numpy/numpy-original.svg" height="75" width="75">
NumPy - это фундаментальная библиотека для математических вычислений, анализа данных и работы с n-мерными масивами, матрицами и формулами. 

---

<img src="https://github.com/mwaskom/seaborn/blob/master/doc/_static/logo-mark-darkbg.png" alt="Seaborn" width="75"/>
Seaborn — это библиотека для создания статистических графиков на Python. Она основывается на matplotlib и тесно взаимодействует со структурами данных pandas.

---

<img src="https://github.com/devicons/devicon/blob/master/icons/scikitlearn/scikitlearn-original.svg" alt="Scikit-learn" width="75"/>
Scikit-learn (sklearn) — это один из наиболее широко используемых пакетов Python для Data Science и Machine Learning. Он содержит функции и алгоритмы для машинного обучения: классификации, прогнозирования или разбивки данных на группы.

---

 <img src="https://brandeps.com/logo-download/C/CatBoost-logo-vector-01.svg" height="75" width="75">
CatBoost - это библиотека машинного обучения. Она использует алгоритмы градиентного бустинга и работает с категориальными и числовыми признаками. CatBoost имеет ряд преимуществ перед другими библиотеками машинного обучения.
Стоит отметить что выбор данной библиотеки основан на импортозамещении, ведь это отечественная библиотека, разработанная компанией Яндекс в 2022, которая идеально подходит для решения поставленной задачи.


## :hammer_and_wrench: Поиск фич и выявление паттернов 

Первым делом мы обратили внимание на датасет с видео: описания к видео векторизировали с помощью TF_IDF_Vectorizer и кластеризовали алгоритмом KMeans. После этого мы смёржили датасеты с историей поиска, видео и целевой переменной. Затем сгенерировали поведенческие признаки юзера на платформе, такие как: автор, которого юзер чаще всего просматривал на платформе, категория и кластер, которые чаще всего фигурировали в его истории поиска, посчитали активность на платформе (сумму запросов), среднее, минимальное и максимальное время, когда юзер начинал смотреть видео, видео с какой длительностью просматривал пользователь и сколько вообще времени юзер смотрел эти видео, кластеризованные девайсы.
Затем были произведены поиск и удаление выбросов в датасете с помощью Isolation Forest. 
Далее была получена информация о датасете, балансе классов, корреляция.
Произвели аугментацию данных для балансировки датасета по целевым переменным.

> Особенностью нашего решения является деление видео на кластеры по их описанию (мы делаем по сути новые категории, которые строятся на основание ключевых слов и различаем видео с тематикой лес, Аниме и тд.) .


## Описание модели

Для классификации использовалась отечественная Open-source бибиотека Catboost. С параметрами моделей можете ознакомится на слайде.По итогу F1-weighted score на тестовых данных по полу составил 0.82, по возрасту 0.58. Также была получен важность признаков. Самой важной оказался автор, которого чаще всего просматривал пользователь, тк он имеет свою целевую аудиторию, отличающуюся по полу и возрасту. Также влияние оказывает регион пользователя, минимальное по продолжительности видео, которое просматривал пользователь, устройство пользователя, категория и кластеры видео.


## Описание файлов, представленных в репозитории

Вся работа с данными идет в файле [parse2.ipynb](https://github.com/zayycev22/age_sex_predictions/blob/main/parse2.ipynb). Сначала считываются данные, в том числе данные по видео, где заранее были кластеризованны по их описанию, после чего происходит обработка данных, избавление от выбросов.
После этого происходит группировка пользователей и начинается обучение моделей на определение социально-демографических признаков.

В качестве тестовых данных проверки моделей, в файле [test_predict.ipynb](https://github.com/zayycev22/age_sex_predictions/blob/main/test_predict.ipynb) были обработаны все event пользователей и предсказаны их пол и возраст.

---

С демонстрацией решения Вы можете ознакомиться [здесь](https://disk.yandex.ru/i/ithFkU3g3w93NQ)



